if(!window.neverland)throw"No neverland found!";import MainWindow from"./mainWindow.js";import GVGPanel from"./panels/gvgpanel.js";import ArmyPanel from"./panels/armypanel.js";import BGPanel from"./panels/bgpanel.js";!function(){var n=window.infoBox.sharedObjectId;const o=window[n],{Component:e,html:t,render:i}=window.neverland,{useSelector:d,useDispatch:a,store:s}=o.store;n=o.gameEvents;const r=document.createElement("div");function c(){const n=o.bgApi;var e=n.getStatus();{const t=a();t({type:"BOT:STATUS_UPDATED",payload:{...e}})}}function l(n){const e=a();if(n){const t=document.querySelector(".main-window");t&&(n=document.body.clientWidth/2-t.getBoundingClientRect().width/2+"px",t.style.left=n),e({type:"BOT:SHOW_MAIN_WINDOW"}),requestAnimationFrame(()=>c())}else e({type:"BOT:HIDE_MAIN_WINDOW"})}r.classList.add("main-layer"),r.id=(268435455*Math.random()<<0).toString(36);const m=e(()=>{const n=d(n=>n);return t`<button onclick=${()=>l(n.botWindowHidden)} class="btn main-button" id="btn-main">F.E.</button>`});function u(n){if(this===n.currentTarget)return n.stopPropagation(),!1}async function p(){{document.body.appendChild(r);const n=e(()=>{var n=d(n=>n)["botWindowHidden"];return t`${m()}<div class="main-window" style=${{visibility:n?"hidden":"visible"}} oninput=${u} onkeydown=${u} onkeyup=${u} onkeypress=${u}>${MainWindow()}</div>${GVGPanel()} ${ArmyPanel()} ${BGPanel()}`});i(r,t`${n()}`),document.body.addEventListener("click",function(n){if(!n.target.closest(".main-layer")&&!s.getState().botWindowHidden){const e=a();e({type:"BOT:HIDE_MAIN_WINDOW"})}}),document.body.addEventListener("keypress",function(n){"KeyZ"===n.code&&n.ctrlKey&&l(s.getState().botWindowHidden)})}}o.injectorApi.events.once(n.MAIN_CITY_READY,async function(){await o.commonLogicReady,p()})}();