import ActionsTab from"./tabs/actions.js";import SettingsTab from"./tabs/settings.js";import AuctionTab from"./tabs/auction.js";import ArmyTab from"./tabs/army.js";import ExpeditionTab from"./tabs/expedition.js";import BGTab from"./tabs/bg.js";import GVGTab from"./tabs/gvg.js";import{NavHeader,Indicator}from"./components/index.js";const sharedObjectId=window.infoBox.sharedObjectId,sharedObject=window[sharedObjectId],gameEvents=sharedObject.gameEvents,_=sharedObject.i18n["_"],{Component,html}=window.neverland,{useSelector,useDispatch}=sharedObject.store,panelsButtons=[{id:"actions-tab",targetId:"actions",label:_("main_window.tabbar.operations")},{id:"settings-tab",targetId:"settings",label:_("main_window.tabbar.settings")},{id:"expedition-tab",targetId:"expedition",label:_("main_window.tabbar.expedition")},{id:"auction-tab",targetId:"auction",label:_("main_window.tabbar.auction")},{id:"army-tab",targetId:"army",label:_("main_window.tabbar.army")},{id:"bg-tab",targetId:"bg",label:_("main_window.tabbar.bg")},{id:"gvg-tab",targetId:"gvg",label:_("main_window.tabbar.gvg")}],PanelHeader=t=>html`<div class="container mb-3"><h3 class="font-weight-bold text-center">${_("title")}</h3>${Indicator({label:_("status"),type:"visual",value:t.isScriptInited&&t.isActive})}</div>`,MainWindow=Component(()=>{var t=useSelector(t=>t)["status"];return html`<div class="control-window">${PanelHeader(t)}<div class="container mt-4">${NavHeader(panelsButtons,tabsSwitchHandler)}<div class="tab-content" id="myTabContent">${ActionsTab()} ${SettingsTab()} ${ExpeditionTab()} ${AuctionTab()} ${ArmyTab()} ${BGTab()} ${GVGTab()}</div></div></div>`});let botConfig;async function loadConfig(){const t=sharedObject.bgApi,a=(botConfig=await t.getConfig(),useDispatch());a({type:"BOT:CONFIG_UPDATED",payload:botConfig})}function setStatuses(t){const a=useDispatch();a({type:"BOT:STATUS_UPDATED",payload:t})}async function updateStatus(t=!1){const a=sharedObject.bgApi;setStatuses(await a.getStatus(t))}async function tabsSwitchHandler(t){const a=sharedObject.bgApi;switch(t){case"auction-tab":{var e=await a.getCurrentAucConfig();const i=useDispatch();i({type:"BOT:CURRENT_AUCTION_CONFIG_UPDATED",payload:e});break}case"ignor-tab":{e=await a.getNicknames();const n=useDispatch();n({type:"BOT:NICKNAMES_UPDATED",payload:e});break}}}sharedObject.injectorApi.events.once(gameEvents.MAIN_CITY_READY,async function(){await sharedObject.commonLogicReady,await sharedObject.backgroundReady,loadConfig(),updateStatus()});export default MainWindow;